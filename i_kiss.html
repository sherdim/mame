
<!DOCTYPE html>

<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Дистанция между строками &#8212; Практикум по математическим методам в исследовательской деятельности</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/book.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/translations.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Алфавитный указатель" href="genindex.html" />
    <link rel="search" title="Поиск" href="search.html" />
    <link rel="next" title="Обнаружение нарушений в структуре" href="i_seq.html" />
    <link rel="prev" title="Структурные модели" href="pr_struct.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Практикум по математическим методам в исследовательской деятельности</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Искать в этой книге ..." aria-label="Искать в этой книге ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Предисловие
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_intro.html">
   Освоение рабочей среды
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="i_python.html">
     Освоение языка Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_sreda.html">
     Подготовка рабочего места
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_sredaonline.html">
     Онлайн-платформы
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_nb.html">
     Создание нового блокнота
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_nb_cell.html">
     Операции с ячейками
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_nb_str.html">
     Строки в кавычках
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_nb_cycle.html">
     Циклы
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_keyboard.html">
     Управление с клавиатуры
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_types.html">
     Разные типы - разное поведение!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_task.html">
     Как работать с блокнотами упражнений?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_rename.html">
     Как переименовать блокнот?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_def.html">
     Функция
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_zaim.html">
     Заимствование кода
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_scriptwork.html">
     Выполнение практических работ на скриптовых языках
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_nbtips.html">
     Памятка
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="z_intro.html">
     * * *
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_stohastic.html">
   Стационарные стохастические процессы
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="i_empiric.html">
     Эмпирические распределения значений
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_data1.html">
     ✍ Получение набора данных
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_hist.html">
     Построение гистограммы распределения
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_random.html">
     Генератор случайных чисел
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_random.html">
     ☑ Генерация случайных выборок
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_eda.html">
   Разведочный анализ
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="i_vector.html">
     Составные типы данных
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_dataset.html">
     Готовые наборы данных
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_pairplot.html">
     Структура данных
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_demographic.html">
     Сведенья о пациентах
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_standart.html">
     Cтандартизация данных
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_turtle.html">
     Работа с таблицами
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_turtle.html">
     ☑ Подготовка данных
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="z_eda.html">
     * * *
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_linear.html">
   Линейные модели
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="i_dataset_rt.html">
     Формирование набора данных
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_normality.html">
     Проверка нормальности распределения
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_groupmean.html">
     Групповая статистика
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_combine.html">
     Объединение наборов данных
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_anova.html">
     Вариационный анализ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_granada.html">
     🗎 Сравнение выборок
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_logscale.html">
     Логарифмирование
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_modeline.html">
     🗎 Сравнение регрессионных моделей
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_retivo.html">
     Подбор параметров распределения
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_plan.html">
   Планирование экспериментов
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="i_power.html">
     Мощность исследования
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_quartile.html">
     Анализ публикационного ландшафта
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_artana.html">
     🗎 Анализ научной статьи
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_nonlinear.html">
   Нелинейные модели
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="w_data2.html">
     ✍ Получение набора данных 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_exp.html">
     Экспоненциальные рост и угасание
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_season.html">
     Сезонные колебания
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_ecg.html">
     Выделение событий в сигнале
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_wav.html">
     Визуализация аудиозаписи
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_spectral.html">
     Спектральный анализ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_spec.html">
     🗎 Спектральный анализ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_perehod.html">
     Переходные процессы
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_prognoz.html">
     Прогнозирование
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_gaupro.html">
     Компоненты нелинейного процесса
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="pr_struct.html">
   Структурные модели
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Дистанция между строками
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_seq.html">
     Обнаружение нарушений в структуре
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_clu.html">
     🗎 Кластерный анализ
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_matrix.html">
   Двумерные массивы данных
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="i_coordinates.html">
     Координаты
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_matrix.html">
     Операции с матрицами
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_dim.html">
     Увеличение размерности
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_pictu.html">
     Обработка изображений
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_pictu.html">
     🗎 Анализ изображения
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_proba.html">
   Вероятностные модели
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="i_sexproba.html">
     Случайность - двигатель прогресса?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_codon.html">
     Частоты кодонов
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_age_logistic.html">
     Скрининговая диагностика
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="i_epistat.html">
     Эпидемиологическая статистика
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="w_epistat.html">
     ☑ Динамика заболеваний
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pr_qual.html">
   Квалиметрические модели
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="w_qual.html">
     🗎 Оценка качества
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pedagogic.html">
   Заметки для преподавателей
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   Список литературы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="annotation.html">
   Аннотация
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Переключить навигацию" aria-controls="site-navigation"
            title="Переключить навигацию" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Загрузите эту страницу"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/i_kiss.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Скачать исходный файл" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Распечатать в PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Полноэкранный режим"
                title="Полноэкранный режим"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/sherdim/mame/gh-pages?urlpath=tree/i_kiss.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Запуск Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Содержание
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   «Расстояние» между двумя строками
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   Чем ближе, тем меньше дистанция
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>Дистанция между строками<a class="headerlink" href="#id1" title="Ссылка на этот заголовок">¶</a></h1>
<p>Белок <a class="reference external" href="http://www.uniprot.org/uniprot/Q15726">kisspeptin</a> (metastin), кодируемый геном <a class="reference external" href="http://www.genecards.org/cgi-bin/carddisp.pl?gene=KISS1">Kiss1/KISS1</a>, рассматривается как главный регулятор  полового созревания посредством регуляции гонадолиберина (GnRH).
У человека этот белок при соединении с рецептором GPR54 на поверхности клеточной мембраны блокирует деление и миграцию клеток, т.е. препятствует метастазам при некоторых опухолях.</p>
<p>В формате FASTA:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">Q15726</span><span class="o">|</span><span class="n">KISS1_HUMAN</span> <span class="n">Metastasis</span><span class="o">-</span><span class="n">suppressor</span> <span class="n">KiSS</span><span class="o">-</span><span class="mi">1</span> <span class="n">OS</span><span class="o">=</span><span class="n">Homo</span> <span class="n">sapiens</span> <span class="n">GN</span><span class="o">=</span><span class="n">KISS1</span> <span class="n">PE</span><span class="o">=</span><span class="mi">1</span> <span class="n">SV</span><span class="o">=</span><span class="mi">4</span>
<span class="n">MNSLVSWQLLLFLCATHFGEPLEKVASVGNSRPTGQQLESLGLLAPGEQSLPCTERKPAA</span>
<span class="n">TARLSRRGTSLSPPPESSGSPQQPGLSAPHSRQIPAPQGAVLVQREKDLPNYNWNSFGLR</span>
<span class="n">FGKREAAPGNHGRSAGRG</span>
</pre></div>
</div>
<div class="figure align-default" id="kiss-3d">
<img alt="" src="_images/kiss_structure_space.png" />
<p class="caption"><span class="caption-number">Рис. 17 </span><span class="caption-text">Пространственная структура кисспептина KISS1 <a class="reference external" href="https://swissmodel.expasy.org/repository/uniprot/Q15726">3D модель</a>.</span><a class="headerlink" href="#kiss-3d" title="Постоянная ссылка на рисунок">¶</a></p>
</div>
<p>Также обнаружен второй вариант кисспептина Kiss2 с другой кодирующей последовательностью, но с похожей ключевой последовательностью аминокислот.</p>
<p>В статье <span id="id2">[<a class="reference internal" href="references.html#id6"><span>KOP09</span></a>]</span> сравниваются последовательности аминокислот в кисспептинах разных позвоночных.</p>
<div class="figure align-default" id="kiss-tree">
<img alt="" src="_images/m_zee0020945640002.jpg" />
<p class="caption"><span class="caption-number">Рис. 18 </span><span class="caption-text">А. Выравнивание аминокислотных последовательностей из последовательности ядра (kisspeptin-10) Kiss1 и kiss2. Консервативные аминокислотные остатки заштрихованы.
B. Филогенетический анализ последовательностей кДНК kiss1 и kiss2. Дерево было построено с использованием метода определения ближайших соседей.
<a class="reference external" href="https://academic.oup.com/endo/article-lookup/doi/10.1210/en.2008-0940">©</a></span><a class="headerlink" href="#kiss-tree" title="Постоянная ссылка на рисунок">¶</a></p>
</div>
<p>Пептидные последовательности составим в виде словарика «метка»:»строка».</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;homo&#39;</span><span class="p">:</span> <span class="s1">&#39;YNWNSFGLRF&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mus&#39;</span><span class="p">:</span> <span class="s1">&#39;YNWNSFGLRY&#39;</span><span class="p">,</span>
    <span class="s1">&#39;platypus&#39;</span><span class="p">:</span><span class="s1">&#39;YNWNSFGLRY&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xenopus&#39;</span><span class="p">:</span> <span class="s1">&#39;YNVNSFGLRF&#39;</span><span class="p">,</span>
    <span class="s1">&#39;medaka1&#39;</span><span class="p">:</span> <span class="s1">&#39;YNLNSFGLRY&#39;</span><span class="p">,</span>
    <span class="s1">&#39;zf1&#39;</span><span class="p">:</span> <span class="s1">&#39;YNLNSFGLRY&#39;</span><span class="p">,</span>
    <span class="s1">&#39;medaka2&#39;</span><span class="p">:</span> <span class="s1">&#39;FNYNPFGLRF&#39;</span><span class="p">,</span>
    <span class="s1">&#39;zf2&#39;</span><span class="p">:</span> <span class="s1">&#39;FNYNPFGLRF&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fugu&#39;</span><span class="p">:</span> <span class="s1">&#39;FNLNPFGLRF&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xenopus2&#39;</span><span class="p">:</span> <span class="s1">&#39;FNFNPFGLRF&#39;</span><span class="p">,</span>
    <span class="s1">&#39;platypus2&#39;</span><span class="p">:</span> <span class="s1">&#39;FNFNPFGLRF&#39;</span><span class="p">,</span>
  <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>«Расстояние» между двумя строками<a class="headerlink" href="#id3" title="Ссылка на этот заголовок">¶</a></h2>
<p>Многие знают игру, как из МУХА сделать СЛОН. За один шаг разрешается менять только одну букву. Эта игра демонстрирует подход для измерения различий между любыми последовательностями символов.
Расстояние между словами измеряется количеством операций редактирования, которые нужны, чтобы из одного слова получить другое. При этом разные варианты таких метрик могут считать прибавление или удаление нескольких символов за одну операцию, или игнорировать пробелы, или не учитывать регистр букв и т.п. Более продвинутые системы распознавания слов учитывают падежные окончания, контекст использования, синонимы и пр. Такие системы используются для исправления запросов в поисковых системах (напр. Яндекс).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;homo&#39;</span><span class="p">],</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;mus&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;YNWNSFGLRF&#39;, &#39;YNWNSFGLRY&#39;)
</pre></div>
</div>
</div>
</div>
<p>Сравнение строк производится по количеству операций.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">o</span><span class="o">=</span><span class="n">difflib</span><span class="o">.</span><span class="n">SequenceMatcher</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;homo&#39;</span><span class="p">],</span> <span class="n">b</span><span class="o">=</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;mus&#39;</span><span class="p">])</span>
<span class="n">o</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9
</pre></div>
</div>
</div>
</div>
<p>Определим функцию, которая будет сравнивать два слова.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">strcompare</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="n">sm</span><span class="o">=</span><span class="n">difflib</span><span class="o">.</span><span class="n">SequenceMatcher</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    
    <span class="c1">#m=sm.find_longest_match(0,11,0,11)</span>
    <span class="c1">#print(&#39;Наиболее длинная последовательность в словах {} и {}:&#39;.format(a,b))</span>
    
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">sm</span><span class="o">.</span><span class="n">get_matching_blocks</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">block</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;совпадение из </span><span class="si">{2}</span><span class="s2"> символов в позициях a[</span><span class="si">{0}</span><span class="s2">] и b[</span><span class="si">{1}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">block</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Чтобы получить из </span><span class="si">{}</span><span class="s1"> =&gt; </span><span class="si">{}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">sm</span><span class="o">.</span><span class="n">get_opcodes</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    </span><span class="si">{:7s}</span><span class="s2"> a[</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">] b[</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">opcode</span><span class="p">))</span>

    <span class="n">p</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Сходство </span><span class="si">{:.1f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">p</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span><span class="o">=</span><span class="s1">&#39;&quot;ТЕРМИНАТОР&quot;&#39;</span>
<span class="n">s2</span><span class="o">=</span><span class="s1">&#39;Терминатор-2&#39;</span>
<span class="n">strcompare</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>совпадение из 1 символов в позициях a[1] и b[0]

Чтобы получить из &quot;ТЕРМИНАТОР&quot; =&gt; Терминатор-2:
    delete  a[0:1] b[0:0]
    equal   a[1:2] b[0:1]
    replace a[2:12] b[1:12]
Сходство 8.3%
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.08333333333333333
</pre></div>
</div>
</div>
</div>
<p>Для человека эти строки практически одинаковы по смыслу. Но для компьютера всего лишь один общий символ - большое Т.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">strcompare</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">s2</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>совпадение из 10 символов в позициях a[1] и b[0]

Чтобы получить из &quot;терминатор&quot; =&gt; терминатор-2:
    delete  a[0:1] b[0:0]
    equal   a[1:11] b[0:10]
    replace a[11:12] b[10:12]
Сходство 83.3%
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8333333333333334
</pre></div>
</div>
</div>
</div>
<p>Если мы приведем эти строки к единому регистру, то сходство обнаруживается.
Операции унификации важны и при сравнении биологических последовательностей. Например, при поиске комплементарных цепей РНК к известному коду ДНК нужно перекодировать все буквы в соответствии с парными комплексами  A-T и G-C.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">strcompare</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;homo&#39;</span><span class="p">],</span> <span class="n">D</span><span class="p">[</span><span class="s1">&#39;mus&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>совпадение из 9 символов в позициях a[0] и b[0]

Чтобы получить из YNWNSFGLRF =&gt; YNWNSFGLRY:
    equal   a[0:9] b[0:9]
    replace a[9:10] b[9:10]
Сходство 90.0%
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9
</pre></div>
</div>
</div>
</div>
<p>Сходные явления при анализе текста и в биологии:</p>
<ul class="simple">
<li><p>Операция редактирования ~ мутация</p></li>
<li><p>Расстояние между строками ~ возраст общего предка</p></li>
<li><p>Приведение к одному регистру ~ трансляция ДНК в РНК</p></li>
<li><p>Не учитывать окончания (стемминг) ~ вырожденность генетического кода</p></li>
<li><p>Контекст использования ~ гидрофильный/гидрофобный конец, отрицательно/положительно заряженный</p></li>
</ul>
</div>
<div class="section" id="id4">
<h2>Чем ближе, тем меньше дистанция<a class="headerlink" href="#id4" title="Ссылка на этот заголовок">¶</a></h2>
<p>Переведем данные о пептидах в табличный вид.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span><span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">index</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>homo</th>
      <td>Y</td>
      <td>N</td>
      <td>W</td>
      <td>N</td>
      <td>S</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>F</td>
    </tr>
    <tr>
      <th>mus</th>
      <td>Y</td>
      <td>N</td>
      <td>W</td>
      <td>N</td>
      <td>S</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>platypus</th>
      <td>Y</td>
      <td>N</td>
      <td>W</td>
      <td>N</td>
      <td>S</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>xenopus</th>
      <td>Y</td>
      <td>N</td>
      <td>V</td>
      <td>N</td>
      <td>S</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>F</td>
    </tr>
    <tr>
      <th>medaka1</th>
      <td>Y</td>
      <td>N</td>
      <td>L</td>
      <td>N</td>
      <td>S</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>zf1</th>
      <td>Y</td>
      <td>N</td>
      <td>L</td>
      <td>N</td>
      <td>S</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>medaka2</th>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>P</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>F</td>
    </tr>
    <tr>
      <th>zf2</th>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>P</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>F</td>
    </tr>
    <tr>
      <th>fugu</th>
      <td>F</td>
      <td>N</td>
      <td>L</td>
      <td>N</td>
      <td>P</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>F</td>
    </tr>
    <tr>
      <th>xenopus2</th>
      <td>F</td>
      <td>N</td>
      <td>F</td>
      <td>N</td>
      <td>P</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>F</td>
    </tr>
    <tr>
      <th>platypus2</th>
      <td>F</td>
      <td>N</td>
      <td>F</td>
      <td>N</td>
      <td>P</td>
      <td>F</td>
      <td>G</td>
      <td>L</td>
      <td>R</td>
      <td>F</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Разные метрики дистанции работают с числами. Поэтому переведем буквы в числа. Поскольку величина этих чисел значения не имеет, пусть это будут коды этих букв в стандартной кодовой странице символов.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="nb">ord</span><span class="p">)</span>
<span class="n">D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>homo</th>
      <td>89</td>
      <td>78</td>
      <td>87</td>
      <td>78</td>
      <td>83</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>70</td>
    </tr>
    <tr>
      <th>mus</th>
      <td>89</td>
      <td>78</td>
      <td>87</td>
      <td>78</td>
      <td>83</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>89</td>
    </tr>
    <tr>
      <th>platypus</th>
      <td>89</td>
      <td>78</td>
      <td>87</td>
      <td>78</td>
      <td>83</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>89</td>
    </tr>
    <tr>
      <th>xenopus</th>
      <td>89</td>
      <td>78</td>
      <td>86</td>
      <td>78</td>
      <td>83</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>70</td>
    </tr>
    <tr>
      <th>medaka1</th>
      <td>89</td>
      <td>78</td>
      <td>76</td>
      <td>78</td>
      <td>83</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>89</td>
    </tr>
    <tr>
      <th>zf1</th>
      <td>89</td>
      <td>78</td>
      <td>76</td>
      <td>78</td>
      <td>83</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>89</td>
    </tr>
    <tr>
      <th>medaka2</th>
      <td>70</td>
      <td>78</td>
      <td>89</td>
      <td>78</td>
      <td>80</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>70</td>
    </tr>
    <tr>
      <th>zf2</th>
      <td>70</td>
      <td>78</td>
      <td>89</td>
      <td>78</td>
      <td>80</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>70</td>
    </tr>
    <tr>
      <th>fugu</th>
      <td>70</td>
      <td>78</td>
      <td>76</td>
      <td>78</td>
      <td>80</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>70</td>
    </tr>
    <tr>
      <th>xenopus2</th>
      <td>70</td>
      <td>78</td>
      <td>70</td>
      <td>78</td>
      <td>80</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>70</td>
    </tr>
    <tr>
      <th>platypus2</th>
      <td>70</td>
      <td>78</td>
      <td>70</td>
      <td>78</td>
      <td>80</td>
      <td>70</td>
      <td>71</td>
      <td>76</td>
      <td>82</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Посчитаем дистанцию Хэмминга, которая отражает степень совпадения отдельных символов, попарно между всеми последовательностями.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">squareform</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="s1">&#39;hamming&#39;</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="c1">#R</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">R</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/i_kiss_24_0.png" src="_images/i_kiss_24_0.png" />
</div>
</div>
<p>Видно, что близкие расстояния (темные квадраты) сосредоточены в двух частях набора данных.</p>
<p>Выполним аггломеративный кластеринг этих данных с использованием алгоритма минимизации дисперсии Уорда.
Другими словами, найдем метрику связи между самыми близкими образцами, затем между группами близких образцов, и так далее вплоть до единой древовидной структуры сходства и различий.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">)</span>
<span class="n">Z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.     ,  2.     ,  0.     ,  2.     ],
       [ 4.     ,  5.     ,  0.     ,  2.     ],
       [ 6.     ,  7.     ,  0.     ,  2.     ],
       [ 9.     , 10.     ,  0.     ,  2.     ],
       [ 0.     ,  3.     ,  1.     ,  2.     ],
       [ 8.     , 14.     ,  6.9282 ,  3.     ],
       [11.     , 12.     , 15.55635,  4.     ],
       [13.     , 16.     , 26.33629,  5.     ],
       [15.     , 17.     , 32.08323,  6.     ],
       [18.     , 19.     , 54.74796, 11.     ]])
</pre></div>
</div>
</div>
</div>
<p>Метрики связи визуализируются в виде дерева (дендрограммы).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">index</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/i_kiss_29_0.png" src="_images/i_kiss_29_0.png" />
</div>
</div>
<p>В базовый рисунок можно добавить необходимые элементы и дополнительное оформление.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fancy_dendrogram</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">max_d</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;max_d&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_d</span> <span class="ow">and</span> <span class="s1">&#39;color_threshold&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_d</span>
    <span class="n">annotate_above</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;annotate_above&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="n">ddata</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;no_plot&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Дендрограмма&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="c1">#         plt.xlabel(&#39;Образец&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Дистанция&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ddata</span><span class="p">[</span><span class="s1">&#39;icoord&#39;</span><span class="p">],</span> <span class="n">ddata</span><span class="p">[</span><span class="s1">&#39;dcoord&#39;</span><span class="p">],</span> <span class="n">ddata</span><span class="p">[</span><span class="s1">&#39;color_list&#39;</span><span class="p">]):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">annotate_above</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.3g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span>
                             <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
                             <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_d</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">max_d</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ddata</span>

<span class="n">ddata</span> <span class="o">=</span> <span class="n">fancy_dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">index</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/i_kiss_31_0.png" src="_images/i_kiss_31_0.png" />
</div>
</div>
<blockquote>
<div><p>С кем человек попал в одну ветку на основании последовательности белка-регулятора полового созревания?</p>
</div></blockquote>
<p>Последовательность кисспептина очень короткая и у одного вида организмов встречается несколько вариантов этого пептида.
Тем не менее этой информации достаточно, чтобы строить структурные модели соотношения между образцами.</p>
<p>Авторы использовали другой метод кластеринга - метод ближайших соседей.
Пептид у мыши отличается от человеческого всего на одну аминокислоту, а у шпорцевой лягушки - на две.
Но если мы посмотрим только на первую и последнюю (сами авторы выделяют два больших семейства Y-Y и F-F пептидов), то значимое сочетание Y-F будет только у человека и лягушки.</p>
<p>Дерево можно разрезать на уровне крупных ветвей, чтобы получить индексы кластеров (групп, ветвей).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_d</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">max_d</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">clusters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 4, 4, 3, 4, 4, 1, 1, 2, 2, 2], dtype=int32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cluster&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>homo         3
mus          4
platypus     4
xenopus      3
medaka1      4
zf1          4
medaka2      1
zf2          1
fugu         2
xenopus2     2
platypus2    2
Name: cluster, dtype: int32
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Какую надо задать максимальную дистанцию (переменная <code class="docutils literal notranslate"><span class="pre">max_d</span></code>), чтобы выделить только два кластера?</p>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">См.также</p>
<p>В 1990 году предложен новый подход к сравнению последовательностей
basic local alignment search tool (BLAST),
в котором оптимизируется мера локального сходства и рассчитывается показатель максимально спаренного сегмента (the maximal segment pair (MSP) score). Этот инструмент используется генетиками при выстраивании огромных геномных последовательностей.</p>
<p><a class="reference external" href="http://biopython.org/DIST/docs/tutorial/Tutorial.html">Biopython</a> - специальная библиотека для работы с объектами молекулярной биологии.</p>
<p><a class="reference external" href="http://nbviewer.jupyter.org/github/biocore/scikit-bio-cookbook/blob/master/Alignments%20and%20phylogenetic%20reconstruction.ipynb">Образец анализа с использованием scikit-bio</a></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="pr_struct.html" title="previous page">Структурные модели</a>
    <a class='right-next' id="next-link" href="i_seq.html" title="next page">Обнаружение нарушений в структуре</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Дмитрий Н. Щербина<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>